<!DOCTYPE html>
<html lang="zh-CN">

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, minimal-ui" />
		<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
		<meta http-equiv="Pragma" content="no-cache" />
		<meta http-equiv="Expires" content="0" />
		<meta name="screen-orientation" content="portrait" />
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="format-detection" content="telephone=no">
		<meta name="full-screen" content="yes">
		<meta name="x5-fullscreen" content="true">
		<title>上海银行2020新春贺卡</title>
		<link rel="stylesheet" href="css/swiper.min.css">
		<link rel="stylesheet" href="css/animate.css">
		<link rel="stylesheet" href="css/style.css">
		<script type="text/javascript">
			(function() {
				var docEl = document.documentElement
				var resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize'
				var reCaculate = function() {
					var clientWidth = docEl.clientWidth
					if (!clientWidth) return
					docEl.style.fontSize = 100 * (clientWidth / 1080) + 'px'
				}
				if (!document.addEventListener) return
				window.addEventListener(resizeEvt, reCaculate, false)
				document.addEventListener('DOMContentLoaded', reCaculate, false)
			})();
		</script>
	</head>
	<body>
		<div class="swiper-container">
			<div class="swiper-wrapper">
				
				<div class="swiper-slide page1">
					<div class="p1-title ani" swiper-animate-effect="bounceInDown" swiper-animate-duration="1s" swiper-animate-delay=".2s"></div>
					<div class="p1-dongwu ani" swiper-animate-effect="rubberBand" swiper-animate-duration="1s" swiper-animate-delay=".2s"></div>
					<div class="p1-icon ani" swiper-animate-effect="bounce" swiper-animate-duration="1s" swiper-animate-delay=".3s"></div>
					<div class="p1-quan ani" swiper-animate-effect="flash" swiper-animate-duration="1s" swiper-animate-delay=".5s"></div>
				</div>
				
				<div class="swiper-slide page2">
					<div class="p2-top ani" swiper-animate-effect="slideInDown" swiper-animate-duration="1s" swiper-animate-delay=".2s"></div>
					<div class="p2-l1 ani" swiper-animate-effect="slideInLeft" swiper-animate-duration="1s" swiper-animate-delay=".2s"></div>
					<div class="p2-l2 ani" swiper-animate-effect="lightSpeedIn" swiper-animate-duration="1s" swiper-animate-delay=".2s"></div>
					<div class="p2-l3 ani" swiper-animate-effect="slideInLeft" swiper-animate-duration="1s" swiper-animate-delay=".2s"></div>
					<div class="p2-r1 ani" swiper-animate-effect="pulse" swiper-animate-duration="1s" swiper-animate-delay=".2s"></div>
					<div class="p2-r2 ani" swiper-animate-effect="slideInRight" swiper-animate-duration="1s" swiper-animate-delay=".2s"></div>
					<div class="p2-r3 ani" swiper-animate-effect="zoomIn" swiper-animate-duration="1s" swiper-animate-delay=".2s"></div>
					<div class="p2-b1 ani" swiper-animate-effect="zoomIn" swiper-animate-duration="1s" swiper-animate-delay=".2s">放入信封</div>
					<div class="p2-b2 ani" swiper-animate-effect="slideInUp" swiper-animate-duration="1s" swiper-animate-delay=".2s"></div>
					<div class="sxfy ani sxfy_write--ani" style="margin: 16vh auto 0;" swiper-animate-effect="sxfy_write--ani" swiper-animate-duration="1s" swiper-animate-delay=".1s">
						<div class="left-box">
							<div>发件人:</div>
							<div class="xiaoInput fajianren" id="fajianren2" contenteditable=true placeholder="发件人姓名"><span>上</span><span>海</span><span>银</span><span>行</span></div>
						</div>
						<div class="inputArea inputTextArea" id="inputTextArea2" maxLength=100 contenteditable=true placeholder="请输入祝福文字（100字以内）"><span>年</span><span>年</span><span>辞</span><span>旧</span><span>，</span><span>岁</span><span>岁</span><span>送</span><span>新</span><span>，</span><span>在</span><span>新</span><span>春</span><span>来</span><span>临</span><span>之</span><span>际</span><span>，</span><span>愿</span><span>您</span><span> </span><span>平</span><span>安</span><span>健</span><span>康</span><span>，</span><span>快</span><span>乐</span><span>幸</span><span>福</span><span>，</span><span>鼠</span><span>年</span><span>快</span><span>乐</span><span>！</span></div>
						<div class="right-box">
							<div>收件人:</div>
							<div class="xiaoInput shoujianren" id="shoujianren2" contenteditable=true placeholder=""></div>
						</div>
						<div class="p2-sx2"></div>
					</div>
				</div>
				<div class="swiper-slide page3">
					<div class="p2-top ani" swiper-animate-effect="slideInDown" swiper-animate-duration="1s" swiper-animate-delay=".2s"></div>
					<div class="p2-l1 ani" swiper-animate-effect="slideInLeft" swiper-animate-duration="1s" swiper-animate-delay=".2s"></div>
					<div class="p2-l2 ani" swiper-animate-effect="lightSpeedIn" swiper-animate-duration="1s" swiper-animate-delay=".2s"></div>
					<div class="p3-l3 ani" swiper-animate-effect="slideInLeft" swiper-animate-duration="1s" swiper-animate-delay=".2s"></div>
					<div class="p2-r1 ani" swiper-animate-effect="pulse" swiper-animate-duration="1s" swiper-animate-delay=".2s"></div>
					<div class="p2-r2 ani" swiper-animate-effect="slideInRight" swiper-animate-duration="1s" swiper-animate-delay=".2s"></div>
					<div class="p2-r3 ani" swiper-animate-effect="zoomIn" swiper-animate-duration="1s" swiper-animate-delay=".2s"></div>
					<div class="p2-b2 ani" swiper-animate-effect="slideInUp" swiper-animate-duration="1s" swiper-animate-delay=".2s"></div>
					<div class="p3-c2 ani" swiper-animate-effect="p3-c2" swiper-animate-duration="1s" swiper-animate-delay="2s"></div>
					
					<div class="xf-box">
						<div class="p-xft ani" swiper-animate-effect="p-xft"></div>
						<div class="p-saix ani" swiper-animate-effect="p-saix"></div>
						<div class="p3-c1"></div>
					</div>
					<div class="p3-c3 ani" swiper-animate-effect="zoomIn" swiper-animate-duration="1s" swiper-animate-delay="0s"
					 onclick="showShare()"></div>
					<div class="p3-yd" id="share" onclick="hideShare()">
						<div class="mm">
							<img src="assets/img/ydjt.png">
						</div>
						<p>点击右上角的分享按钮可以分享给自己的好友！</p>
					</div>
				</div>


			</div>
		</div>
		<div class="audio" id="audio_btn" onclick="plays()">
			<audio id="bg-music" src='./assets/bgm/audio.m4a' autoplay loop preload></audio>
		</div>
		<script src="./js/jquery-1.12.4.min.js"></script>
		<script src="./js/jweixin-1.6.0.js"></script>
		<script src="./js/sha1.js"></script>
		<script src="./js/wxShare.js"></script>
		<script src="./js/swiper.min.js"></script>
		<script src="./js/swiper.animate1.0.3.min.js"></script>
		<script type="text/javascript">
			var mySwiper = new Swiper('.swiper-container', {
				direction: 'vertical', // 垂直切换选项
				on: {
					init: function() {
						swiperAnimateCache(this); //隐藏动画元素 
						swiperAnimate(this); //初始化完成开始动画
					},
					slideChangeTransitionEnd: function() {
						swiperAnimate(this); //每个slide切换结束时也运行当前slide动画
						//this.slides.eq(this.activeIndex).find('.ani').removeClass('ani'); 动画只展现一次，去除ani类名
					},
					touchStart(event) {
						if (this.activeIndex === 1) {
							this.allowSlideNext = false
						} else {
							this.allowSlideNext = true
						}
						this.allowSlidePrev = true
					}
				}
			})
			mySwiper.slideTo(1)
			setTimeout(function(){
				setInterval(function(){
					if($('.page1').hasClass('page1-other')) {
						$('.page1').removeClass('page1-other')
					} else {
						$('.page1').addClass('page1-other')
					}
					if($('.page2').hasClass('page2-other')) {
						$('.page2').removeClass('page2-other')
					} else {
						$('.page2').addClass('page2-other')
					}
					if($('.page3').hasClass('page2-other')) {
						$('.page3').removeClass('page2-other')
					} else {
						$('.page3').addClass('page2-other')
					}
				}, 1000)
			}, 3500)
			function showShare() {
				setTimeout(() => {
					getAppId(function(data) {
						let fjr = $('#fajianren2').html()
						let sjr = $('#shoujianren2').html() || ''
						let zfy = $('#inputTextArea2').html()
						wxConfig(data, fjr, sjr, zfy)
						document.querySelector('#share').classList.add('show')
					})
					mySwiper.detachEvents();
				})
			}

			function hideShare() {
				document.querySelector('#share').classList.remove('show')
				mySwiper.attachEvents()
			}

			function autoPlayMusic() {
				// 自动播放音乐效果，解决浏览器或者APP自动播放问题
				function musicInBrowserHandler() {
					musicPlay(true);
					document.body.removeEventListener('touchstart', musicInBrowserHandler);
				}
				document.body.addEventListener('touchstart', musicInBrowserHandler);

				// 自动播放音乐效果，解决微信自动播放问题
				function musicInWeixinHandler() {
					musicPlay(true);
					document.addEventListener("WeixinJSBridgeReady", function() {
						musicPlay(true);
					}, false);
					document.removeEventListener('DOMContentLoaded', musicInWeixinHandler);
				}
				document.addEventListener('DOMContentLoaded', musicInWeixinHandler);
			}

			function musicPlay(isPlay) {
				var media = document.querySelector('#bg-music');
				if (isPlay && media.paused) {
					media.play();
				}
				if (!isPlay && !media.paused) {
					media.pause();
				}
			}

			function plays() {
				var audio = document.getElementById('bg-music');
				if (audio !== null) {
					if (audio.paused) {
						audio.play(); // 播放
					} else {
						audio.pause(); // 暂停
					}
				}
			}
			autoPlayMusic()

			$('.p2-b1').on('click', function() {
				let tx = $('#inputTextArea2').html()
				if (tx === '') {
					alert('请输入祝福语')
					return
				}
				mySwiper.allowSlideNext = true
				mySwiper.slideNext()
			})
			$('.fajianren,.inputTextArea,.shoujianren').on('blur', function(){
				window.scrollTo(0, 0)
			})
		</script>
	</body>
</html>
